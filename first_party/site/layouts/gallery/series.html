{{/*
Gallery Series Layout

Parameters: the series key of the series to display
*/}}

{{ define "main" }}

{{ $allItemsByKey := partial "gallery/items-by-key.html" . }}

{{ $selectedSeries := dict }}
{{ range site.Data.gallery.series }}
{{ if eq .key $.Params.key }}
{{ $selectedSeries = . }}
{{ end }}
{{ end }}

<div class="content root wide-root">
  <div class="content block stack wide">
    <ol class="content items wide-items" role="list">
      {{ range $selectedSeries.items }}

      {{ $item := index $allItemsByKey . }}
      {{ if not $item }}
      {{ errorf "Gallery item '%v' not found in series '%v'" . $selectedSeries.key }}
      {{ end }}

      <li>
        {{ $subtitle := partial "gallery/subtitle.html" $item }}

        {{ partial "card/composition/gallery-card.html" (dict
        "image" (strings.TrimPrefix "/static" $item.thumbnail)
        "title" $item.title
        "subtitle" $subtitle
        "link" (printf "/gallery/item/%s" $item.key))
        }}
      </li>
      {{ end }}
    </ol>
  </div>
</div>
{{ end }}