{{/*
Repository Technologies Layout

Parameters:
* key: "technologies" (implied)
*/}}

{{ define "main" }}

<div class="content root wide-root">
  {{ range site.Data.repository.technologies }}
  {{ $tech := . }}

  {{ $items := slice }}
  {{ range site.Data.repository.items }}
  {{ if in .technologies $tech.key }}
  {{ $items = $items | append . }}
  {{ end }}
  {{ end }}

  {{ if gt (len $items) 0 }}
  {{ $subtitle := printf "All projects that use or target <a href=\"%s\">%s</a>" $tech.link $tech.name }}
  {{ $expandByDefault := partial "repository/expansion-state.html" "technologies" }}

  <details class="content block" {{ if eq $expandByDefault "expanded" }}open{{ end }}>
    <summary id="{{ $tech.key | urlize }}">
      {{ partial "content-block-header.html" (dict "title" $tech.name "subtitle" $subtitle) }}
    </summary>
    <ol class="content items wide-items" role="list">
      {{ range $items }}
      <li>
        {{ $icons := partial "utils/tech-icons.html" .technologies }}

        {{ partial "card/composition/repository-card.html" (dict
        "images" $icons
        "title" .title
        "subtitle" .description
        "link" .link)
        }}
      </li>
      {{ end }}
    </ol>
  </details>
  {{ end }}
  {{ end }}
</div>
{{ end }}