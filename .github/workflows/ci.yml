name: CI

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-20.04

    steps:
      # Checkout repository as working directory.
      - uses: actions/checkout@v2

      # Build all targets.
      - name: build_all
        run: bash presubmit/all_targets_build.sh

      # Test all applicable targets.
      - name: test_all
        run: presubmit/all_tests_pass.sh

      # Check all Kotlin files are already formatted properly
      - name: check_format
        run: presubmit/all_kotlin_files_formatted
